# 소프트웨어 요구사항 명세서 (SRS)
# Software Requirements Specification

| 항목 | 내용 |
|------|------|
| **문서 버전** | 1.3.0 |
| **작성일** | 2026-02-16 |
| **기반 문서** | 유저스토리 v1.3.0, 사용자 인터뷰 (2026-02-15, 2026-02-16) |
| **형식** | IEEE 830 기반 |
| **티켓** | TICKET-084 |

---

## v1.3.0 버전 증가 근거 (Minor: 1.2.0 → 1.3.0)

- 기존 요구사항(US-001~US-020, FR-001~FR-018)의 의미/호환성을 유지하면서 신규 전략 요구사항 1건(US-021, 전략D)을 확장 추가했다.
- 기능 추가(Feature Addition)에 해당하므로 Patch가 아닌 Minor 버전으로 증가했다.

---

## v1.3.0 변경 로그 (요약)

- 2026-02-16 4차 인터뷰 기반 신규 전략D(US-021) 요구사항 추가(FR-019)
- 전략D 핵심 규칙 반영: 다중 종목 동시 모니터링(1~20), 첫 조건 충족 종목 우선 매수
- 전략D 매수 규칙 반영: 2분봉, 09:03 기준가, 1% 하락 후 전저점 추적, 전저점 대비 0.2% 반등 시 2분봉 종가 전액 매수
- 공통 제약 반영 확대: 당일 손절 미적용, 매수/매도 교대(연속 매수 금지)
- 제약(CON)과 기능(FR) 분리: 전략D 특화 제약(CON-009~CON-011) 명시
- 추적 매트릭스에 US-021 ↔ FR-019 매핑 및 커버리지 수치 갱신

---

## 1. 서론

### 1.1 목적

본 문서는 주식투자 전략 시뮬레이션 시스템의 소프트웨어 요구사항을 정의한다. v1.3.0은 v1.2.0을 기준선으로 계승하면서, 2026-02-16 4차 인터뷰에서 도출된 신규 전략D 요구사항을 증분 반영한다.

### 1.2 범위

- **v1.2.0 계승 범위**: FR-001~FR-018, NFR-001~NFR-008, BR-001~BR-010 및 기존 추적성 구조
- **v1.3.0 신규 범위**: 전략D(US-021) 기능 요구사항(FR-019), 전략D 제약(CON-009~CON-011), 비즈니스 규칙(BR-011), 추적성 갱신

---

## 2. 전체 설명

### 2.1 제품 기능 요약 (v1.3.0)

| 기능 영역 | 주요 기능 |
|-----------|----------|
| 시세 데이터 수집 | 코스피 종목 5분/3분/2분 분봉 데이터 조회, RSI 지표 조회 |
| 투자 전략 | 기존 전략 3종 + 신규 전략 A/B/C/D |
| 시뮬레이션 실행 | 매매 비용 반영, 시드머니 누적 관리, 전략별 단일 포지션 운용 |
| 결과 보고서 | 수익률·수익금·세부 거래 내역·종합 보고서 |

### 2.2 제약사항

| ID | 제약사항 |
|----|---------|
| CON-001 | 시세 데이터는 Yahoo Finance API에 의존하며, API 가용성·데이터 범위에 제한될 수 있다 |
| CON-002 | 분봉 데이터 조회 가능 기간은 최근 60일로 제한된다 |
| CON-003 | 시뮬레이션은 과거 데이터 기반이며, 실시간 매매를 수행하지 않는다 |
| CON-004 | 기본 시뮬레이션 단위는 단일 포지션 운용이며, 동시 다중 포지션 보유는 허용하지 않는다 |
| CON-005 | 매수 수수료는 반영하지 않으며, 매도 시 세금(0.2%)과 수수료(0.011%)만 반영한다 |
| CON-006 | 신규 전략(A/B/C/D)은 당일 손절매(15:00 강제 손절)를 적용하지 않는다 |
| CON-007 | 신규 전략(A/B/C/D)은 미청산 포지션 보유 중 추가 매수를 금지하며, 매수→매도 교대만 허용한다 |
| CON-008 | 전략C는 3분 분봉 기준, 오전 9시 3분(09:03) 기준가를 사용한다 |
| CON-009 | 전략D의 동시 모니터링 종목 수는 최소 1개, 최대 20개로 제한한다 |
| CON-010 | 전략D에서 동일 시점 복수 종목이 매수 조건을 만족하면 우선순위상 첫 번째 종목 1건만 매수한다 |
| CON-011 | 전략D는 2분 분봉 및 오전 9시 3분(09:03) 기준가 규칙을 강제한다 |

---

## 3. 기능 요구사항 (Functional Requirements)

### 3.1 계승 요구사항

- v1.2.0의 기능 요구사항 `FR-001 ~ FR-018`은 본 문서에서 변경 없이 그대로 계승한다.

### 3.2 신규 요구사항

#### FR-019: 2분봉 다중 종목 동시 모니터링 기반 매수 Trailing Buy + 매도 Trailing Stop 조합 전략 (전략 D, 신규 전략)

| 항목 | 내용 |
|------|------|
| **요구사항 ID** | FR-019 |
| **우선순위** | High |
| **출처** | US-021 |

**설명**: 시스템은 2026-02-16 4차 인터뷰에서 정의된 신규 전략D를 지원해야 한다. 여러 종목을 동시에 모니터링해 첫 조건 충족 종목에 진입하고, 매수 후 매도 Trailing Stop으로 청산한다.

**상세 요구사항**:

*매수 준비 및 모니터링:*
1. 시스템은 사용자 입력으로 전략D 모니터링 종목 목록(1~20개)을 받는다.
2. 시스템은 각 거래일 오전 9시 3분(09:03) 시초가격을 종목별 기준가로 설정한다.
3. 시스템은 각 모니터링 종목에 대해 2분 분봉 종가 기준으로 기준가 대비 하락률을 계산한다.

*매수 조건 — 하락 추적/반등 진입:*
4. 종목별로 기준가 대비 1.0% 이상 하락이 최초 발생하면 해당 종목의 전저점 추적을 시작한다.
   - 하락 판정: (기준가 - 현재가) / 기준가 × 100 ≥ 1.0%
5. 전저점 추적 시작 후, 2분 분봉 단위로 종목별 최저가를 갱신한다.
6. 전저점 대비 현재가(2분 분봉 종가)가 0.2% 이상 상승하면 매수 후보로 판정한다.
   - 반등 판정: (현재가 - 전저점) / 전저점 × 100 ≥ 0.2%
7. 동일 시점 복수 후보 발생 시 우선순위상 첫 번째 종목 1건만 선택해 해당 2분 분봉 종가로 전액 매수한다.
8. 매수 수량은 현재 시드머니 전액을 매수 가격으로 나눈 최대 주식 수(정수)이다.

*매도 조건:*
9. 매수 후 매도 전략은 전략 1(FR-003)의 이익보전 매도 조건과 동일하다.
   - 매수가 대비 1.0% 이상 수익 확보 시 이익보전 추적 시작
   - 이익보전율 80% 이하 시 즉시 매도

*운용 제약 적용:*
10. 전략D는 당일 손절매(15:00 강제 손절)를 적용하지 않는다.
11. 미청산 포지션 보유 중에는 추가 매수를 수행하지 않는다.
12. 거래 순서는 매수→매도→매수→매도 교대만 허용하며, 연속 매수(매수→매수)는 허용하지 않는다.

---

## 4. 비기능 요구사항 (Non-Functional Requirements)

- v1.2.0의 비기능 요구사항 `NFR-001 ~ NFR-008`을 변경 없이 계승한다.

---

## 5. 외부 인터페이스 요구사항

### 5.1 데이터 인터페이스 확장 (전략D)

| 항목 | 내용 |
|------|------|
| 추가 Interval | `2m` (2분 분봉) |
| 적용 전략 | 전략D (FR-019) |
| 사용 시점 | 종목별 09:03 기준가 설정 및 매수 조건 판정 |

---

## 6. 데이터 요구사항

### 6.1 분봉 데이터 구조 확장

- 기존 5분/3분 분봉 구조를 계승하며, 전략D를 위해 2분 분봉을 동일 스키마로 추가 지원한다.

---

## 7. 비즈니스 규칙

### 7.1 계승 규칙

- v1.2.0의 비즈니스 규칙 `BR-001 ~ BR-010`을 변경 없이 계승한다.

### 7.2 신규 규칙

#### BR-011: 전략 D(신규 전략) — 2분봉 다중 종목 동시 모니터링 매수 Trailing Buy + 매도 Trailing Stop 조건

| 항목 | 내용 |
|------|------|
| **규칙 ID** | BR-011 |
| **모니터링 종목 수** | 최소 1개, 최대 20개 |
| **기준가** | 종목별 오전 9시 3분(09:03) 시초가격 |
| **하락 추적 시작** | 기준가 대비 현재가 하락률 ≥ 1.0% |
| **전저점 추적** | 하락 추적 시작 후 2분 분봉 최저가 갱신 |
| **매수 조건** | 전저점 대비 현재가 상승률 ≥ 0.2%일 때 2분 분봉 종가 전액 매수 |
| **동시 후보 처리** | 동일 시점 복수 후보 중 우선순위상 첫 번째 종목 1건만 매수 |
| **매도 조건** | 전략 1(BR-005)의 이익보전 매도 조건과 동일 |
| **당일 손절매** | 적용하지 않음 |
| **추가 매수 제한** | 미청산 포지션 보유 시 추가 매수 금지 |
| **거래 순서 제약** | 매수→매도 교대만 허용, 연속 매수 금지 |

---

## 8. 유저스토리-요구사항 추적 매트릭스

### 8.1 유저스토리 → 기능 요구사항 매핑 (v1.3.0)

| 유저스토리 ID | 기능 요구사항 ID | 비고 |
|-------------|----------------|------|
| US-001 ~ US-020 | FR-001 ~ FR-018 | v1.2.0 매핑 그대로 계승 |
| US-021 | FR-019 | 전략D 신규 매핑 |

### 8.2 유저스토리 → 비기능 요구사항 매핑

| 유저스토리 ID | 비기능 요구사항 ID | 비고 |
|-------------|------------------|------|
| US-016 | NFR-003 | 계승 |
| US-017 | NFR-005 | 계승 |
| US-006 | NFR-008 | 계승 |

### 8.3 전체 커버리지 요약 (v1.3.0)

| 항목 | 수량 |
|------|------|
| 총 유저스토리 수 | 21 (US-001 ~ US-021) |
| 기능 요구사항 수 | 19 (FR-001 ~ FR-019) |
| 비기능 요구사항 수 | 8 (NFR-001 ~ NFR-008) |
| 총 요구사항 수 | 27 |
| 유저스토리 커버리지 | 21/21 (100%) |

### 8.4 역추적: 요구사항 → 유저스토리 (증분)

| 요구사항 ID | 유저스토리 ID | 비고 |
|------------|-------------|------|
| FR-019 | US-021 | 신규 |
| BR-011 | US-021 | 신규 규칙 |
| CON-009 ~ CON-011 | US-021 | 신규 제약 |
| FR-001 ~ FR-018, NFR-001 ~ NFR-008, BR-001 ~ BR-010 | 기존 매핑 계승 | v1.2.0 참조 |

---

## 9. 변경 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 1.3.0 | 2026-02-16 | 신규 전략D(US-021, FR-019) 요구사항 추가, 전략D 제약(CON-009~CON-011) 및 비즈니스 규칙(BR-011) 반영, 추적 매트릭스/커버리지 갱신 | SRS 담당 에이전트 |
| 1.2.0 | 2026-02-16 | 신규 전략C(US-020, FR-018) 요구사항 추가, 전략C 제약(CON-008) 및 비즈니스 규칙(BR-010) 반영, 추적 매트릭스 갱신 | SRS 담당 에이전트 |
| 1.1.0 | 2026-02-16 | 신규 전략A/B(US-018, US-019) 요구사항 추가, 기존/신규 전략 스코프 분리, 추적 매트릭스 갱신 | SRS 담당 에이전트 |
| 1.0.0 | 2026-02-15 | 최초 작성 | SRS 담당 에이전트 |
